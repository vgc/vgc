// Copyright 2024 The VGC Developers
// See the COPYRIGHT file at the top-level directory of this distribution
// and at https://github.com/vgc/vgc/blob/master/COPYRIGHT
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

#include <gtest/gtest.h>
#include <vgc/core/stopwatch.h>
#include <vgc/geometry/segmentintersector2.h>

using vgc::Int;
using namespace vgc::core;
using namespace vgc::geometry;

Vec2dArray polyline200 = {
    {-94.04404640058124, -199.06237425395116},
    {-96.4563427267596, -197.26057213893208},
    {-98.89246238578329, -195.49112671520732},
    {-101.3516664191186, -193.75407823634328},
    {-103.83265957449044, -192.0496254652403},
    {-106.33400464231403, -190.3783597338694},
    {-108.85467070257096, -188.74128993911458},
    {-111.39410811805277, -187.1394781801282},
    {-113.95200574439019, -185.57369284285656},
    {-116.52806449494398, -184.04449776032132},
    {-119.12202785765527, -182.55256363712064},
    {-121.73375175700289, -181.09859558747166},
    {-124.36306511395361, -179.68294480925388},
    {-127.00958303887859, -178.30552469475217},
    {-129.67276895541272, -176.96614864069366},
    {-132.35215860520083, -175.6648128576586},
    {-135.04743585447153, -174.40161643211937},
    {-137.7582809994238, -173.1765354448008},
    {-140.48421020936667, -171.98937359664646},
    {-143.2245705202114, -170.83988403466716},
    {-145.97867444761766, -169.72790974695354},
    {-148.74594801970682, -168.65340681981323},
    {-151.5260185487968, -167.61637111575246},
    {-154.31871299929503, -166.6167788852707},
    {-157.12395489049146, -165.65458865837613},
    {-159.94164724696867, -164.72978892118195},
    {-162.7716607745391, -163.84240040568193},
    {-165.6139646327482, -162.99236099058123},
    {-168.4687525830547, -162.1795434898003},
    {-171.33639899367864, -161.40403327233642},
    {-174.21736629054027, -160.6663476942075},
    {-177.11215098941813, -159.9672661827395},
    {-180.02112620672722, -159.30748348419067},
    {-182.94423317489384, -158.6875154322171},
    {-185.88079288118348, -158.1078720156289},
    {-188.82978864729102, -157.56915259545318},
    {-191.79053017408927, -157.0718379039181},
    {-194.76281119157903, -156.61590266207634},
    {-197.746262457206, -156.2007727696263},
    {-200.7396436875386, -155.8258821976972},
    {-203.74110511844822, -155.4912897342643},
    {-206.75339259503693, -155.19420402427326},
    {-209.79230624860833, -154.92122701392563},
    {-212.88537660060433, -154.64939075271135},
    {-216.0546520223823, -154.36381483676348},
    {-219.29814976714218, -154.07789049459123},
    {-222.5885676224926, -153.83567144241775},
    {-225.88660659700022, -153.69651566626908},
    {-227.51943295288362, -153.68428695638713},
    {-229.15112904222323, -153.7191015806361},
    {-230.7479468773264, -153.80665259798468},
    {-232.3396237912534, -153.95271666806823},
    {-233.8791940228424, -154.15806867493282},
    {-235.4080468868389, -154.42868843772234},
    {-236.8731470658583, -154.75769544578617},
    {-238.32172683762897, -155.15266035486468},
    {-239.7057321611864, -155.59979088389628},
    {-241.0682731502615, -156.10902574969518},
    {-242.37379308199914, -156.66442504878512},
    {-243.65365423066746, -157.27691641901023},
    {-244.88347569278724, -157.93239975682553},
    {-246.0833925243854, -158.6410727908204},
    {-247.23445290884692, -159.3906188722218},
    {-248.35086698411087, -160.19059924520425},
    {-249.41651703421445, -161.0293951001975},
    {-250.44234195730007, -161.91614639297924},
    {-251.41694850639504, -162.84177852388984},
    {-252.34633279550565, -163.81253996119912},
    {-253.2258626893772, -164.8253395768655},
    {-254.05508067878876, -165.87962187218727},
    {-254.83589032885683, -166.97979163397616},
    {-255.56229512896303, -168.11670211374087},
    {-256.24028207187155, -169.30114679117239},
    {-256.8612284825331, -170.5166947810748},
    {-257.43236938970443, -171.77786700240136},
    {-257.9455237474725, -173.06405148442357},
    {-258.4075384514516, -174.39074937167004},
    {-258.8121685168669, -175.73640879293967},
    {-259.1652471826291, -177.11599831034965},
    {-259.46231127652607, -178.50900200002104},
    {-259.70759860024316, -179.92925610958076},
    {-259.89813671968864, -181.35806731500972},
    {-260.036227324047, -182.8069952757645},
    {-260.12063603685124, -184.26017589438095},
    {-260.1523490955154, -185.7254379769401},
    {-260.1317301038024, -187.19103494108288},
    {-260.0594805454376, -188.66179793968405},
    {-259.93655542536214, -190.12931018959534},
    {-259.7632834921054, -191.59865410164483},
    {-259.5407827098776, -193.0614226382229},
    {-259.26789896126, -194.52623124240637},
    {-258.9470034932298, -195.98134612119495},
    {-258.5748415695168, -197.44012632632337},
    {-258.1564983259665, -198.88649080274877},
    {-257.6872224718537, -200.33746696053726},
    {-257.17490039366635, -201.77404753490444},
    {-256.6143203912894, -203.21442345043596},
    {-256.0147448898117, -204.63925630555806},
    {-255.37105770480593, -206.06524865020344},
    {-254.69237831411843, -207.47512315139326},
    {-253.22377413221764, -210.27392752868047},
    {-251.62349329717162, -213.02916244427465},
    {-249.90594620483844, -215.7339158756673},
    {-248.0861735218541, -218.3779267585856},
    {-246.18030858411558, -220.94774597608384},
    {-244.20584452751868, -223.42910940393756},
    {-242.1782007362042, -225.810142224516},
    {-240.10272584118118, -228.08843102736273},
    {-237.96931686418642, -230.27662467538525},
    {-235.7560319554682, -232.39688640016232},
    {-233.4406585591008, -234.4624396691851},
    {-231.01303676201664, -236.46000862661336},
    {-229.759342465826, -237.42103341086045},
    {-228.4809869168604, -238.34825691544248},
    {-227.18724917485275, -239.23083541050602},
    {-225.86625405247756, -240.07088479736066},
    {-224.5454278852752, -240.84699402772588},
    {-223.19605856421865, -241.57049013238046},
    {-221.8618588835151, -242.2145026986106},
    {-221.18466473159276, -242.51370173360237},
    {-220.499944735021, -242.79458631601318},
    {-219.83666392444167, -243.04709254267905},
    {-219.16767233577906, -243.283176222169},
    {-218.49271562680616, -243.50028360158478},
    {-217.81153945529582, -243.69586092802805},
    {-217.15639335825557, -243.8624194586102},
    {-216.49692475825876, -244.0096004852638},
    {-215.83341653659863, -244.135159424231},
    {-215.16615157456835, -244.23685169175414},
    {-214.52415282867517, -244.31158751903723},
    {-213.88017971790845, -244.36440469445466},
    {-213.23499499675358, -244.39395811864253},
    {-212.5893614196961, -244.39890269223685},
    {-211.96087912886523, -244.37964597031515},
    {-211.33359331677838, -244.33696412697103},
    {-210.7084193445097, -244.27067557972254},
    {-210.0862725731335, -244.1805987460877},
    {-209.46784654530205, -244.06637637064435},
    {-208.8541417149458, -243.92846754601732},
    {-208.2458308105032, -243.76779958248943},
    {-207.64358656041276, -243.58529979034344},
    {-207.03163147045154, -243.37477583827646},
    {-206.42770488807247, -243.14152735775497},
    {-205.83193486016353, -242.88733582192282},
    {-205.24444943361271, -242.61398270392394},
    {-204.63837373074261, -242.30701239748555},
    {-204.04285015673062, -241.97945759921632},
    {-203.45746127520488, -241.63339638845827},
    {-202.88178964979346, -241.2709068445535},
    {-202.28529047781356, -240.8707195590494},
    {-201.70085366042397, -240.45269872355126},
    {-201.12774655334485, -240.0187543407685},
    {-200.5652365122964, -239.57079641341053},
    {-199.98605076657904, -239.08510352876107},
    {-199.41964488337874, -238.58424638291694},
    {-198.3211019014522, -237.54410012372037},
    {-197.23021466326588, -236.4161949404949},
    {-196.1839036408848, -235.2454228570769},
    {-195.16261381742328, -234.01745853678207},
    {-194.1783183986077, -232.75843556327737},
    {-193.22776735056252, -231.4771059902503},
    {-192.30315285447585, -230.1761537148527},
    {-190.53089518919455, -227.56962425892},
    {-188.82157310235357, -224.97720300450155},
    {-187.1382232139212, -222.41503771844492},
    {-185.45761113205663, -219.8861516456876},
    {-183.77088103538182, -217.38369698293414},
    {-182.0765478462729, -214.897353437683},
    {-180.37424846794812, -212.4214680639382},
    {-178.66318005869408, -209.9547573741414},
    {-176.94310143311372, -207.49613112798002},
    {-175.21378025327925, -205.0449404852745},
    {-173.4742911938393, -202.60181831447883},
    {-171.72389080276156, -200.1676137477635},
    {-169.96266492582248, -197.74250488490256},
    {-168.19121265483813, -195.32617937795746},
    {-166.4103916914866, -192.91807570664147},
    {-164.62102040234316, -190.51763035992},
    {-162.82327652734517, -188.12470719229518},
    {-161.01632050593827, -185.73988344710088},
    {-159.19876911931254, -183.3641446558909},
    {-157.36955605746226, -180.99825746454488},
    {-155.5283284997991, -178.64244248899345},
    {-153.6750957926552, -176.2966113279257},
    {-151.8096179670461, -173.96083659087833},
    {-149.9311289749416, -171.63558831923558},
    {-148.03876696527283, -169.32142394942113},
    {-146.1321763449635, -167.01850559345164},
    {-144.21131168844693, -164.7267330608871},
    {-142.27572563196497, -162.446337578126},
    {-140.3243766933066, -160.17809509126639},
    {-138.35608209978255, -157.92295549126587},
    {-136.37031139484634, -155.68135192777166},
    {-134.36806795012927, -153.4525081238789},
    {-132.35251543171404, -151.2339901103428},
    {-130.3279635366216, -149.02236881412952},
    {-128.2972307898388, -146.81516584772524},
    {-126.26061059139624, -144.61190977638304},
    {-124.21777496154596, -142.41317212302},
    {-122.16912820755232, -140.21931488081609},
};

Vec2dArray polyline1k = {
    {353.68333333333334, -22.1666666666664},   {350.0340653091312, -19.645336597299092},
    {346.2959507924124, -17.28455243335992},   {342.4940010047821, -15.032552990099589},
    {338.59543549316, -12.947761846229753},    {334.6011380858819, -11.034139141992853},
    {330.5174773003221, -9.291028237246564},   {326.3523690411734, -7.716590763243744},
    {322.1152684403691, -6.308476434434738},   {317.8168488804599, -5.06465563754972},
    {313.46822792548534, -3.983673555675182},  {309.08022840030486, -3.06412339468352},
    {304.66333333082736, -2.3044096589769083}, {300.22757348307783, -1.7042128934072593},
    {295.7767210987859, -1.2635979577980265},  {291.2947103243246, -0.9761878941567943},
    {286.74381829001544, -0.8272491925969803}, {282.0879576252706, -0.8051850730382171},
    {277.3253364047517, -0.9183830474342471},  {272.50142280794495, -1.202404733784988},
    {270.09496452080555, -1.4249928041738518}, {267.6973892306351, -1.7171623538653193},
    {265.34922994797705, -2.0821602505087027}, {264.1818124096249, -2.297680555911494},
    {263.02109654254804, -2.5437079876517146}, {260.79887344153235, -3.0961031126150553},
    {259.7014951965449, -3.4162991765823176},  {258.61752877369196, -3.775818982899864},
    {257.60334557580165, -4.150812088311729},  {256.60266229244075, -4.5571271797354616},
    {255.62020020369636, -5.00133371020891},   {255.13727750733244, -5.239699219163604},
    {254.66068058965533, -5.490001132769919},  {253.779620323909, -5.990251266532836},
    {252.92135247395618, -6.52686908956139},   {252.5021916006207, -6.809672224331747},
    {252.0904399060956, -7.102594889156271},   {251.6866677486683, -7.405979619947549},
    {251.29144548662606, -7.720168952618167},  {250.92035736430032, -8.03175183910789},
    {250.55729035504896, -8.352659877686921},  {250.2024410338936, -8.682654757961348},
    {249.85600597585568, -9.021498169537256},  {249.51818175595673, -9.368951802020739},
    {249.18916494921834, -9.724777345017879},  {248.86915213066197, -10.088736488134769},
    {248.55833987530917, -10.460590920977495}, {248.25908046881355, -10.838286214958814},
    {247.96993229229327, -11.223923464654126}, {247.69067445283804, -11.61702580192963},
    {247.42108605753748, -12.017116358651515}, {246.9100340277592, -12.836354657899207},
    {246.4350090596759, -13.67782341732675},   {245.99014280636584, -14.556337167446701},
    {245.5861473678143, -15.455161949802779},  {245.2203127703849, -16.371183093816907},
    {244.88992904044113, -17.301285928911},    {244.59042891024575, -18.26236003185536},
    {244.33015676449935, -19.235196888548245}, {244.10725878058787, -20.21779832665011},
    {243.91988113589713, -21.20816617382144},  {243.7675400566793, -22.21001478396035},
    {243.65241698441767, -23.21693274903089},  {243.57395166932332, -24.227516704179205},
    {243.53158386160754, -25.24036328455145},  {243.52504075772094, -26.247081649787194},
    {243.5544423855175, -27.253299569572015},  {243.6203250482861, -28.25766045306421},
    {243.72322504931577, -29.258807709422115}, {243.86193016622937, -30.250074925130733},
    {244.0366062168406, -31.235492213509787},  {244.2478805635801, -32.21351090319515},
    {244.49638056887858, -33.18258232282267},  {244.7852501345612, -34.15204616351371},
    {245.1107827755289, -35.10986048143714},   {245.47229405570846, -36.05473152679211},
    {245.86909953902665, -36.98536554977778},  {246.31626047425522, -37.930784875612964},
    {246.79959506305113, -38.858659016553034}, {247.31638945705186, -39.76889314879888},
    {247.86392980789486, -40.66139244855137},  {248.47104720840537, -41.57656842450014},
    {249.11097513924713, -42.46984733634264},  {249.77971065901937, -43.34274711026448},
    {250.47325082632125, -44.19678567245131},  {251.22766868445808, -45.07132431610789},
    {252.00914363259963, -45.92254138397052},  {253.63741896472533, -47.565170531776346},
    {254.5140250233036, -48.38908861727238},   {255.41154251503545, -49.19080111644579},
    {257.2565174094976, -50.73858989865573},   {259.20927497478567, -52.25159639690595},
    {261.2148303241385, -53.696330989788635},  {263.27985617506494, -55.08979155254136},
    {265.3824768670083, -56.42778898025725},   {269.6124817272092, -58.929889645532626},
    {273.7802743156621, -61.210050333524066},  {277.8445627434083, -63.28875876805773},
    {281.85460136977264, -65.19163831238359},  {285.8863676515818, -66.93683649475776},
    {289.9808020480759, -68.53203794735128},   {294.14242958151107, -69.98067809046881},
    {298.36888124123783, -71.28606688724739},  {302.6614398935197, -72.45192453284585},
    {307.0206175980176, -73.48392078981507},   {311.4421467447866, -74.38902510849181},
    {315.9180164377205, -75.17224995273111},   {320.44304444093865, -75.83555091119655},
    {325.0202610469316, -76.38095058429104},   {329.65748919799586, -76.81152124757111},
    {334.35622853956005, -77.12511966697889},  {339.1051462891359, -77.30190503698117},
    {343.8992101539447, -77.30421799276303},   {348.75329313581534, -77.09947395325673},
    {353.66356248153505, -76.6764567977603},   {356.1121516748134, -76.38453147289633},
    {358.55189386655405, -76.03070774052532},  {360.9224231108847, -75.62214798719808},
    {363.2762699549508, -75.13493384031364},   {365.5043892810419, -74.58389528226044},
    {366.6082916135216, -74.27360892004543},   {367.7026844007498, -73.93324196406826},
    {368.7318334105288, -73.58325228227585},   {369.7515891181299, -73.208307076436},
    {370.7594850563952, -72.80457181589068},   {371.75305475816657, -72.36821196998187},
    {372.6862632954138, -71.92209991787692},   {373.6050663102393, -71.44793593605243},
    {374.5070326453847, -70.94366597921666},   {375.3897311435913, -70.40723600207781},
    {376.2209819030943, -69.8600747884045},    {377.0324853311631, -69.2844214422377},
    {377.8223171528597, -68.6798864803829},    {378.5885530932463, -68.04608041964565},
    {379.3131734870466, -67.39875863559575},   {380.0131564058298, -66.72489920420244},
    {380.6874439693278, -66.02536965928958},   {381.33497829727236, -65.30103753468103},
    {381.9505114127391, -64.55749954402907},   {382.5376157634703, -63.791167459042796},
    {383.0960746105937, -63.003527265968465},  {383.62567121523733, -62.19606495105228},
    {384.13077937762074, -61.36041580773052},  {384.604785974063, -60.50651792106787},
    {385.04818626274846, -59.636046342320725}, {385.46147550186134, -58.75067612274549},
    {385.8540808264381, -57.826258324497516},  {386.21381284948694, -56.88826991094147},
    {386.54197325810594, -55.938399559262464}, {386.8398637393936, -54.97833594664564},
    {387.11658424927543, -53.97148571629519},  {387.3598706587885, -52.95570187420192},
    {387.5718189605599, -51.932481840994754},  {387.7545251472164, -50.903323037302584},
    {387.9129809800405, -49.828079165054035},  {388.0390381022098, -48.74823462419233},
    {388.1351795939023, -47.66489572089479},   {388.203888535296, -46.579168761338735},
    {388.2456787425941, -45.45634140499164},   {388.25734869610267, -44.33253354786393},
    {388.19988730794313, -42.084735007001285}, {388.0346702220894, -39.78822387398204},
    {387.7681622050158, -37.500294946129685},  {387.4008252657381, -35.186881489344245},
    {386.9410470406306, -32.88938437432728},   {386.38733009599787, -30.58228396129696},
    {385.74839031371874, -28.296870706402444}, {385.02120565991197, -26.013656658786385},
    {384.2147906269052, -23.756860823358693},  {383.3265595319989, -21.51382432703325},
    {382.3648545605777, -19.300966202503105},  {381.3306877093998, -17.115124894342273},
    {380.22891634494187, -14.962274777728112}, {379.06683831483974, -12.850748561836},
    {377.84252260482464, -10.774505347628121}, {376.5692071038443, -8.75143369281561},
    {375.2379025152159, -6.765971627123918},   {373.8646599533146, -4.839517395091496},
    {372.43675630991646, -2.953209701289893},  {370.97039294825754, -1.1270283116097304},
    {369.45225905301953, 0.6563279491001026},  {367.8989382677846, 2.3783042236197853},
    {366.29658420344725, 4.054703837082457},   {364.6641285385441, 5.666252585699158},
    {362.9855515194192, 7.229677674026959},    {361.28319087258967, 8.724828228768036},
    {359.5381227783585, 10.169941435422345},   {357.77555709460216, 11.545466428848144},
    {355.9740635537151, 12.869654912769704},   {354.16045526789617, 14.124419499739572},
    {352.3115861815956, 15.326616003243657},   {350.45441920713847, 16.45991203263271},
    {348.56531205739765, 17.53902917816481},   {346.67058907942624, 18.54948818610132},
    {344.74706914589905, 19.503835832971276},  {342.8202323340147, 20.389628712725795},
    {340.8678355879451, 21.217398536500127},   {338.91360486996143, 21.977261311792184},
    {336.93724127308104, 22.677358444149206},  {334.95905458713713, 23.310611773835795},
    {332.96230815916266, 23.882405968308092},  {330.9626135659763, 24.38810262211746},
    {328.94808163751355, 24.83073381638212},   {326.9286508119335, 25.20775009667583},
    {324.89829760191293, 25.52048128123249},   {322.8599344618557, 25.76812341956867},
    {320.81471565803184, 25.950870449242927},  {318.75733737012, 26.068921348273918},
    {316.6972066371757, 26.122098267002173},   {314.6203281878751, 26.110541490010142},
    {312.5447140450063, 26.034707805355083},   {310.4477905025151, 25.89361762370358},
    {308.35596585208174, 25.68932810958796},   {306.2389608906402, 25.41878839726938},
    {304.1306533810786, 25.08644177011911},    {301.99454735317096, 24.686433858994516},
    {299.8704922277364, 24.22615385827345},    {297.7175320285754, 23.69656928836517},
    {295.5797539363271, 23.1082769058101},     {293.4142067956943, 22.449288510844077},
    {291.2668166790813, 21.73306360167794},    {289.09637585930096, 20.945642631570223},
    {286.94701412548085, 20.10222329576419},   {284.782253370733, 19.188006767066817},
    {282.6414388864362, 18.21892595827478},    {280.49300912171793, 17.18009085096136},
    {278.3711666965913, 16.087835189282032},   {274.1555134875885, 13.716699769226466},
    {270.0180657972622, 11.118681712161958},   {267.98732875242086, 9.739404714041871},
    {265.99124707885136, 8.310640289899936},   {264.02971185478293, 6.831236471358051},
    {262.10736023178293, 5.301599409342884},   {260.22360868154146, 3.7181311292729267},
    {258.3839397680035, 2.0838861060515796},   {256.5811165543797, 0.38936612097243095},
    {254.82655894082978, -1.3550206568025942}, {253.11336042335495, -3.1565866192054157},
    {251.45264114242428, -5.006454778755312},  {249.85459475802574, -6.892121432839022},
    {248.31596848080477, -8.825892070970951},  {246.87637386160776, -10.75882609778327},
    {245.50785018412847, -12.741338941386061}, {244.2758504983306, -14.682467344855029},
    {243.6906438870386, -15.671191018272388},  {243.1307267544865, -16.674016305833163},
    {242.14705607735146, -18.591838231720253}, {241.69237338899336, -19.56804495753786},
    {241.26779448450685, -20.557180849279916}, {240.89922333362995, -21.490582348315844},
    {240.5571154207874, -22.433527272353263},  {240.24501277273095, -23.386164718665423},
    {239.96645741621245, -24.348643784525564}, {239.73627487257454, -25.26057760411249},
    {239.5364339569034, -26.179347064414138},  {239.36902489502194, -27.104177750969296},
    {239.2361379127529, -28.034295249316756},  {239.14247540568422, -28.928390146299378},
    {239.08148670113096, -29.82530515061025},  {239.05325239435612, -30.723843318488687},
    {239.0578530806228, -31.622807706174},     {239.09535388485483, -32.50557359276147},
    {239.16552715291238, -33.386557692785274}, {239.26692906167705, -34.26477705819312},
    {239.39811578803057, -35.139248740932715}, {239.56143881614216, -36.01860136694262},
    {239.75559920268438, -36.891932206956696}, {239.9786403169753, -37.758693392011445},
    {240.22860552833293, -38.618337053143364}, {240.51577542740955, -39.500444084921966},
    {240.83145647728176, -40.37300745574043},  {241.17370251569986, -41.23583436415943},
    {241.54056738041407, -42.08873200873964},  {241.95233514292323, -42.973782734622034},
    {242.39044179478097, -43.846352333188804}, {242.85289986280196, -44.706605799788726},
    {243.33772187380094, -45.554708129770574}, {243.87325785404033, -46.43581841388245},
    {244.43285755368072, -47.302137855458355}, {245.61551909253473, -48.9929959841221},
    {246.26852409461307, -49.8594090445325},   {246.94279716334927, -50.709689204806054},
    {248.34613849588317, -52.36631884564241},  {249.8807449722048, -54.03267603465967},
    {251.47974872750746, -55.638664016106134}, {253.19232826225678, -57.23920199573567},
    {254.95924387999588, -58.78052998456474},  {256.8229134055798, -60.30393610864114},
    {258.7328440656091, -61.76967934977222},   {260.72496966974984, -63.20849172149913},
    {262.75662650412715, -64.59158012434284},  {264.8549478692988, -65.94048297820889},
    {266.98691258649643, -67.2361375970616},   {271.37382489710336, -69.69345175791187},
    {275.8646823140544, -71.95332944822178},   {280.4065260505343, -74.00514862074306},
    {284.94337564004576, -75.83496031637003},  {289.426055893846, -77.42475451092804},
    {293.8609221583667, -78.77138175276485},   {298.3487327230436, -79.91224230040774},
    {303.02402514099737, -80.90316430070226},  {305.4677875967916, -81.35170507828394},
    {307.9204056395733, -81.743863431551},     {310.40514323224795, -82.07923818295609},
    {311.65005619088834, -82.21837089302737},  {312.89724614729477, -82.3286085344194},
    {315.29608000279495, -82.47044667606804},  {316.49520364148344, -82.49810909659666},
    {317.6932607093673, -82.48342351380597},   {318.7866548464772, -82.43502951374197},
    {319.8765245509253, -82.35474240537599},   {320.96005517972776, -82.23232803359181},
    {321.4985637648295, -82.15212495044413},   {322.03443208990103, -82.05755224327336},
    {322.97818706792634, -81.85876784148081},  {323.910943919225, -81.62021332498352},
    {324.37172531564016, -81.4838669604668},   {324.8279899023194, -81.33499169136931},
    {325.2791485865781, -81.17272539238954},   {325.72461227573154, -80.99620593822596},
    {326.1165696348663, -80.82712075406528},   {326.5037096878669, -80.64753957057562},
    {326.88552000575606, -80.45732102188643},  {327.26148815955685, -80.25632374212728},
    {327.63110172029224, -80.04440636542762},  {327.99384825898517, -79.82142752591699},
    {328.3492153466585, -79.58724585772485},   {328.69669055433536, -79.34171999498074},
    {329.0126988673966, -79.10251801529223},   {329.32095441419744, -78.85327894402087},
    {329.62135532775216, -78.59442161953346},  {329.91379974107497, -78.32636488019675},
    {330.19818578717985, -78.04952756437754},  {330.47441159908107, -77.7643285104426},
    {330.7423753097927, -77.47118655675872},   {331.001975052329, -77.17052054169267},
    {331.2504222190999, -76.86448169930907},   {331.48915257666044, -76.55059299960661},
    {331.7184614609646, -76.2294075984246},    {331.9386442079664, -75.90147865160239},
    {332.1499961536196, -75.5673593149793},    {332.3528126338784, -75.22760274439469},
    {332.7340205420283, -74.53339052469818},   {332.9194447598344, -74.16392761083031},
    {333.09459707056624, -73.78931869665661},  {333.25992858582254, -73.4099938196058},
    {333.4158904172021, -73.0263830171067},    {333.70150947472587, -72.2480237854785},
    {333.95506313592745, -71.45768130120206},  {334.1902406563489, -70.60083482935048},
    {334.38715935814014, -69.73367543092681},  {334.54929320479863, -68.85841881644114},
    {334.6801161598219, -67.97728069640362},   {334.7863942325803, -67.02102723004998},
    {334.8560172502064, -66.0609186816756},    {334.89200838767994, -65.09832512407895},
    {334.89739081998067, -64.13461663005853},  {334.8690730309409, -63.09069316449051},
    {334.80545728825297, -62.047912224929206}, {334.7095759708144, -61.00706182318429},
    {334.58446145752265, -59.96892997106539},  {334.41651455252196, -58.8502745404734},
    {334.2150223230097, -57.736766445396775},  {333.9833592035172, -56.62861190048833},
    {333.724899628576, -55.526017120400866},   {333.4176415704079, -54.34992626396296},
    {333.0795753686057, -53.181899240157186},  {332.3265577983755, -50.86812948747399},
    {331.426750463737, -48.45203175138166},    {330.43689086100943, -46.06955219385168},
    {329.32740697169675, -43.62757080191132},  {328.1480466922214, -41.21712010194966},
    {325.5924103798906, -36.419430472831834},  {322.9243413595629, -31.798488349430556},
    {320.2695572172656, -27.446393607767448},  {317.67017055368314, -23.377468023309063},
    {315.0857213786856, -19.5292587378151},    {312.4540048181912, -15.81799209509228},
    {309.74527215614495, -12.192320391217038}, {306.96320951537103, -8.638448691295025},
    {304.1179380379148, -5.155669749080801},   {301.21253355115704, -1.7425728594857333},
    {298.24326005546703, 1.6031715644659812},  {295.20397684827077, 4.883320784800617},
    {292.0908047195034, 8.097517673164475},    {288.902846552712, 11.242925637448366},
    {285.6393493116288, 14.315421698473585},   {282.2984453900844, 17.313357794604315},
    {278.8796684090882, 20.240973369762912},   {275.3866206209926, 23.106269288090118},
    {271.8261016037798, 25.913582746131226},   {268.20443554946866, 28.658372832644545},
    {264.5232830441891, 31.334553943459355},   {260.77614053830797, 33.94881830156322},
    {256.9491834120708, 36.51742883731396},    {253.02930300478357, 39.038666733034404},
    {249.00938221388873, 41.467542885261196},  {246.9445745224753, 42.63118926939315},
    {244.8517603572853, 43.74170769299087},    {242.68416448226077, 44.811165518292874},
    {240.48395337818891, 45.80935984496318},   {238.21276491518876, 46.74562447297368},
    {237.06488760583488, 47.18091964333968},   {235.90735142537045, 47.58861434658968},
    {233.6239538455498, 48.31459902162125},    {232.47118401093135, 48.63384604606257},
    {231.30905318899755, 48.91222482421932},   {230.23762831743056, 49.135079056268914},
    {229.16250464096657, 49.327056957635264},  {228.0836969235196, 49.474280466208704},
    {227.5429161631506, 49.526772428788796},   {227.00121992900364, 49.562871519879536},
    {226.04996372675166, 49.59362285713031},   {225.57508862668055, 49.59370615076981},
    {225.10142063915248, 49.581460671428964},  {224.62948859804723, 49.55528602686544},
    {224.15982133724464, 49.51358182483693},   {223.69294769062455, 49.45474767310112},
    {223.22939649206677, 49.37718317941568},   {222.8169510346052, 49.29240736701581},
    {222.4076532237131, 49.19455229359974},    {222.00225527039174, 49.083184088580836},
    {221.60150938564226, 48.95786888137247},   {221.20616778046588, 48.81817280138804},
    {220.8169826658638, 48.66366197804092},    {220.4347062528372, 48.49390254074449},
    {220.06009075238734, 48.308460618912136},  {219.70466193813036, 48.11353089148389},
    {219.3572802722775, 47.904329900705484},   {219.01822882163893, 47.68145941997833},
    {218.6877906530247, 47.44552122270389},    {218.36624883324495, 47.19711708228358},
    {218.05388642910978, 46.936848772118864},  {217.7509865074293, 46.66531806561115},
    {217.45783213501358, 46.3831267361619},    {217.16105331460926, 46.07484051271759},
    {216.87657519296562, 45.754781670884746},  {216.6041084840724, 45.423805532319264},
    {216.34336390191945, 45.08276741867702},   {216.09405216049652, 44.732522651613934},
    {215.85588397379345, 44.37392655278589},   {215.62857005579997, 44.007834443848786},
    {215.41182112050592, 43.63510164645851},   {215.1859853298031, 43.216058428178336},
    {214.97499883623516, 42.788975001125834},  {214.7780791044001, 42.35461210576601},
    {214.59444359889582, 41.91373048256387},   {214.42330978432028, 41.467090871984425},
    {214.26389512527135, 41.01545401449268},   {213.97709313214517, 40.10023152063235},
    {213.83596769507383, 39.58254937210572},   {213.7103663366293, 39.06053130414092},
    {213.5990540907151, 38.53469664935183},    {213.50079599123472, 38.00556474035228},
    {213.33850236718982, 36.93948649017727},   {213.21360573572298, 35.86645121452676},
    {213.1216668502033, 34.68422238764826},    {213.0788264062616, 33.49752543000826},
    {213.07420293966717, 32.308000578443526},  {213.0969149861893, 31.117288069790845},
    {213.15136322566605, 29.86976160672271},   {213.24088547055203, 28.62346070687238},
    {213.49418284253346, 26.134727085697364},  {213.8274959592511, 23.66891828567525},
    {214.24064695449846, 21.21421076658976},   {214.70292443817647, 18.865905482851574},
    {215.23429097147692, 16.5323302949746},    {215.81358550257698, 14.299529352081644},
    {216.45864502371847, 12.084780516540945},  {217.16241984189327, 9.916244045592013},
    {217.92501954400882, 7.7671068893959045},  {219.61505350970475, 3.502448723548639},
    {221.4813787609143, -0.7212300120359032},  {223.47680459229406, -4.89478793930499},
    {225.56447974923134, -9.009692390167288},  {227.717297233196, -13.058748304850155},
    {229.92137225192192, -17.03727801762591},  {232.1800064430642, -20.944885144782518},
    {234.5085450839079, -24.78527928029291},   {236.92135262507878, -28.562713548438296},
    {239.42408891924077, -32.27791240143492},  {242.01678947539932, -35.92828987296707},
    {244.69896406121705, -39.512573461397096}, {247.4706125279401, -43.033401000550555},
    {250.33249182224012, -46.49400472690195},  {253.28627660385865, -49.89477337153846},
    {256.33329826252833, -53.23457246880676},  {259.4729954215772, -56.51155791852176},
    {262.703341636361, -59.71760935605238},    {266.0218756192282, -62.83420231610205},
    {269.4287601602659, -65.83635591439077},   {272.9372322083089, -68.69608805755428},
    {274.75397852768583, -70.07241592339402},  {276.6077477377416, -71.39708271162547},
    {278.5536866287987, -72.69734039466383},   {280.5414325992918, -73.93127925592367},
    {282.6425384085201, -75.13341216178077},   {284.78763763996886, -76.25299931570254},
    {286.99980913281206, -77.29658978974514},  {288.1217331998298, -77.78148952587233},
    {289.2558063681276, -78.23598833772712},   {290.36272186195833, -78.64833519358979},
    {291.47832825580826, -79.03410104346423},  {292.60368387286644, -79.38658692257907},
    {293.73984703632215, -79.69909386616291},  {294.79917126878433, -79.95338814765732},
    {295.8647912313549, -80.17446780958487},   {296.93641862242066, -80.35501846447252},
    {298.01376514036855, -80.48772572484728},  {298.9839694506903, -80.5658162135473},
    {299.95528736498056, -80.60503113201419},  {300.4407119641106, -80.60806766529925},
    {300.9256326128288, -80.59899420149287},   {301.4097885273339, -80.57701370575066},
    {301.89291892382454, -80.54132914322824},  {302.7462716349197, -80.4462417234277},
    {303.1705841695896, -80.38342021408735},   {303.59271327174775, -80.30962864947921},
    {304.01220327744943, -80.22427838787252},  {304.4285985227498, -80.12678078753648},
    {304.8414433437039, -80.01654720674031},   {305.2502820763669, -79.89298900375326},
    {305.6162370415864, -79.77002674614299},   {305.9784599363429, -79.63681333330597},
    {306.33644512411007, -79.4931587305147},   {306.6896869683613, -79.33887290304165},
    {307.0376798325701, -79.17376581615932},   {307.37991808021, -78.99764743514024},
    {307.7158960747546, -78.81032772525683},   {308.04510817967724, -78.61161665178167},
    {308.35535321682363, -78.40934037975435},  {308.6586578668681, -78.19666146321688},
    {308.95487053753783, -77.97398980724208},  {309.2438396365601, -77.74173531690282},
    {309.5254135716619, -77.500307897272},     {309.7994407505705, -77.25011745342243},
    {310.0657695810131, -76.99157389042702},   {310.3242484707169, -76.7250871133586},
    {310.5856089310203, -76.4372668061769},    {310.83703007292553, -76.14038721903107},
    {311.0789725139111, -75.83518043698983},   {311.31189687145525, -75.52237854512188},
    {311.5362637630364, -75.2027136284959},    {311.752533806133, -74.8769177721806},
    {312.1626258167859, -74.20986158075681},   {312.3752378567472, -73.83399864241208},
    {312.57698144047487, -73.45191875803587},  {312.7686190636806, -73.0642201942652},
    {312.9509132220762, -72.67150121773705},   {313.29052112728436, -71.87339509295643},
    {313.60190512179344, -71.06238651679007},  {313.9127319804975, -70.15239685073394},
    {314.1865364238164, -69.22960085325238},   {314.4287492157731, -68.29676642782286},
    {314.64480112039035, -67.35666147792273},  {314.84971952926674, -66.32906485013771},
    {315.0222517952339, -65.29502577739805},   {315.16624223517704, -64.25597113739468},
    {315.2855351659811, -63.21332780781859},   {315.3860780636735, -62.094380713396426},
    {315.45770963198277, -60.97293968977694},  {315.52437725570104, -58.725639911370195},
    {315.4913081743821, -56.329630960427615},  {315.3577118757185, -53.93631424469652},
    {315.1145467600016, -51.40177699438313},   {314.77490658378775, -48.87763445243007},
    {314.32123572614336, -46.23949919682424},  {313.77836981969466, -43.617374469463755},
    {313.1341039191617, -40.939446375105526},  {312.4147832320593, -38.27960479442339},
    {310.797206571236, -33.03799437444485},    {309.08625721752304, -28.059926201465657},
    {307.41434164549975, -23.412548174753965}, {305.81781207674106, -19.025355411699252},
    {304.251298291267, -14.7668694226262},     {302.6619313133345, -10.546986831628999},
    {301.0346349675206, -6.338739451119693},   {299.37796063701563, -2.139714936490293},
    {297.6959180784053, 2.0519310768066816},   {295.98294495966144, 6.238873655733016},
    {294.2344610245072, 10.426055643409484},   {292.462017904457, 14.620296196837671},
    {290.6920245825275, 18.827324800720987},   {288.95263549511543, 23.049319031747473},
    {287.27063992864686, 27.288539944423405},  {285.6504953589886, 31.612252773618877},
    {284.0815058685392, 36.17684788230849},    {283.3178431219295, 38.617366619309685},
    {282.6198864524252, 41.07576635510259},    {281.98625575639926, 43.60085896908173},
    {281.7055941271423, 44.87031400604466},    {281.46183691580103, 46.146354817147255},
    {281.2622978713458, 47.351953878887485},   {281.09048484218, 48.560072267412636},
    {280.95959263004255, 49.77070752810782},   {280.9136152059031, 50.37696821845202},
    {280.882816036673, 50.98385720635815},     {280.8575212566416, 52.033352722440796},
    {280.8700045356499, 53.08000198678123},    {280.89511025305376, 53.60110454425866},
    {280.93529725212943, 54.12010986245319},   {280.99244445518076, 54.63655604924903},
    {281.0684307845117, 55.149981212530406},   {281.22637593827585, 55.984315351583675},
    {281.32083890093566, 56.396565107428685},  {281.42806648654414, 56.80389313385571},
    {281.5498869694237, 57.20506679064208},    {281.68812862389706, 57.598853437565104},
    {281.7639787262071, 57.79259143225828},    {281.84461972428664, 57.984020434402126},
    {281.9302801524258, 58.17298636396879},    {282.021188544915, 58.359335140930455},
    {282.1818575616174, 58.66328358818599},    {282.3536463257043, 58.960293340360295},
    {282.53710408943226, 59.24877461286549},   {282.7327801050578, 59.52713762111367},
    {282.8353715986624, 59.66202796845765},    {282.94122362483756, 59.79379258051693},
    {283.05040484011533, 59.922232734218},     {283.1629839010279, 60.04714970648739},
    {283.2790294641072, 60.16834477425159},    {283.39861018588545, 60.285619214437126},
    {283.5217947228945, 60.39877430397052},    {283.6486517316667, 60.50761131977828},
    {283.77060421474806, 60.60537916315379},   {283.8956220339432, 60.699293407669366},
    {284.0235631072785, 60.789372884012444},   {284.1542853527804, 60.875636422870514},
    {284.2876466884753, 60.95810285493101},    {284.4235050323896, 61.036791010881416},
    {284.56171830254965, 61.11171972140917},   {284.70214441698204, 61.18290781720174},
    {284.844641293713, 61.250374128946596},    {284.98906685076895, 61.314137487331195},
    {285.1352790061764, 61.37421672304299},    {285.28313567796175, 61.43063066676945},
    {285.58321424277165, 61.5325380010162},    {285.8881658894098, 61.620010135571135},
    {286.0587088706992, 61.661619466290986},   {286.23063849739765, 61.69776874791763},
    {286.40385095764674, 61.72869602825123},   {286.57824243958794, 61.75463935509198},
    {286.7537091313628, 61.77583677624008},    {286.9301472211129, 61.79252633949571},
    {287.28552234710486, 61.81333408353028},   {287.6435373226961, 61.81896696959719},
    {288.00336165301894, 61.811329380097945},  {288.36416484320574, 61.79232569743402},
    {288.7251163983888, 61.763860304006926},   {289.1551149834911, 61.71547216932579},
    {289.58329962114954, 61.64919494520203},   {290.00962031455333, 61.566682381037445},
    {290.4340270668919, 61.46958822623384},    {290.85646988135437, 61.35956623019302},
    {291.2768987611302, 61.23827014231679},    {292.1115147293788, 60.96847068866532},
    {292.6026287508892, 60.791910334071595},   {293.08878892016673, 60.601389199745064},
    {294.04706659444633, 60.18281815755576},   {294.98798553706365, 59.72146469342179},
    {295.9131835328646, 59.226035938667565},   {296.9537140020864, 58.61735205492873},
    {297.96967667112904, 57.96622107043893},   {298.9641102577969, 57.27992381822244},
    {299.9400534798944, 56.565741131303525},   {300.9835804547931, 55.75354587713422},
    {302.00147671826767, 54.90795279608605},   {303.9780709963723, 53.1432895397287},
    {304.96245502192346, 52.20774195020522},   {305.92507013879765, 51.24895759563155},
    {307.80338083629334, 49.28272878691621},   {309.556595298749, 47.33776768956423},
    {311.2626731335933, 45.34954885678894},    {314.3579261622561, 41.54617693292221},
    {317.2135048671383, 37.85569558851745},    {319.9527563035895, 34.18100956295444},
    {322.6293614844075, 30.482789518781658},   {325.2512257696183, 26.77495280638476},
    {327.81646136853914, 23.06007085044854},   {330.3191008168747, 19.322969315229102},
    {332.7554259853245, 15.547503644746598},   {335.1266273917352, 11.728342988153372},
    {337.43626864596416, 7.869046052269596},   {339.6869879045087, 3.9742776386428886},
    {341.88022767211083, 0.04608026703874657}, {344.0180397604076, -3.9158707518718074},
    {346.10434497222406, -7.91250717633352},   {348.1434958972314, -11.943740276313292},
    {350.13689930310323, -16.00850646022832},  {352.08123003429586, -20.10648187433287},
    {353.97304483213367, -24.24043350094422},  {355.8159661383333, -28.416797952602735},
    {357.6200688906944, -32.64284381680807},   {359.39064366250483, -36.92201709954463},
    {361.1161845538741, -41.25129444030199},   {362.76971286368445, -45.62606569908286},
    {364.32883705636795, -50.0647478610299},   {365.78379570578005, -54.621234434503265},
    {367.1106163574721, -59.34074307353126},   {367.70730833988716, -61.75776469450682},
    {368.2392235924893, -64.1887906308784},    {368.69370567740214, -66.61228913444754},
    {369.0612314864957, -69.04868762732264},   {369.3208002327723, -71.41863675159561},
    {369.41187268534065, -72.60639992250205},  {369.470752056589, -73.79569126399315},
    {369.49750507308744, -74.93569333856642},  {369.4962441179863, -76.07554571316271},
    {369.4630339204465, -77.21426529176158},   {369.3939392096291, -78.35086897834259},
    {369.2944988099438, -79.43525203024484},   {369.1632280284687, -80.51581569861601},
    {368.99720137569045, -81.59099013284938},  {368.79349336209526, -82.65920548233828},
    {368.56395517111423, -83.67265606912896},  {368.30091111276215, -84.67745679121109},
    {368.0018550572826, -85.6714688714357},    {367.66428087491937, -86.65255353265388},
    {367.3064810948968, -87.5763037590388},    {366.91481238470664, -88.48564872177022},
    {366.48719379548686, -89.37785732269971},  {366.0215443783755, -90.25019846367877},
    {365.53926272502537, -91.06782600745449},  {365.0237680664942, -91.86436204372613},
    {364.47400790915606, -92.63683396292171},  {363.88892975938535, -93.38226915546917},
    {363.2856216307509, -94.08102794475607},   {362.651284816753, -94.75139703726384},
    {361.9864575606926, -95.39103265086534},   {361.2916781058705, -95.99759100343334},
    {360.5709443795448, -96.56704265141565},   {359.8235369745691, -97.10123032295897},
    {359.05150948148815, -97.5994841594876},   {358.25691549084667, -98.06113430242581},
    {357.4261018251068, -98.49182123252618},   {356.57518206638895, -98.88245565543583},
    {355.70688337069674, -99.23447485848172},  {354.8239328940343, -99.54931612899082},
    {353.89831736374754, -99.83417720881661},  {352.96033092749303, -100.07761590479302},
    {352.0123490213414, -100.28240776637315},  {351.05674708136286, -100.45132834301009},
    {350.05735612302834, -100.58837687931012}, {349.0528361587074, -100.685547794948},
    {348.0448015260107, -100.74551695503327},  {347.03486656254864, -100.77096022467552},
    {345.98173483071133, -100.76096006870489}, {344.9293550523297, -100.71331937776543},
    {343.8788343128267, -100.62994738220439},  {342.83127969762523, -100.512753312369},
    {341.741575157208, -100.35460210820044},   {340.65750834928457, -100.16021028044435},
    {339.5798543356464, -99.93143533001297},   {338.5093881780851, -99.6701347578186},
    {337.4011963378716, -99.3626192172543},    {336.3029079082369, -99.0201528034551},
    {335.2145586829427, -98.6457884591294},    {334.13618445575145, -98.24257912698565},
    {333.0282822460271, -97.79248256740652},   {331.9332495442858, -97.31060472088808},
    {329.77679677174655, -96.26988079875},     {327.60564406708477, -95.10044746099216},
    {325.4790016200746, -93.8475766450274},    {323.35983368632265, -92.50611682476622},
    {321.27778035402815, -91.10541748641714},  {317.2123535402612, -88.17413937056972},
    {313.32184958256806, -85.1557604870456},   {309.62473413511583, -82.09728994640307},
    {306.1113972925968, -78.99265878605001},   {302.75899997481037, -75.81661728462171},
    {299.55215465370424, -72.55852162114343},  {296.4894970541199, -69.22596872422434},
    {293.5748210625066, -65.82650350419584},   {290.80800059935444, -62.355722072104186},
    {288.1847761398066, -58.80033877208916},   {285.7010579976539, -55.14704802185588},
    {283.3566606050678, -51.38899029172211},   {281.15464716356274, -47.52553497114002},
    {279.09857718968345, -43.559301592204065}, {277.1918869830485, -39.49546644905894},
    {275.4389852451092, -35.3427289618912},    {273.8451865382521, -31.111117586485193},
    {272.4161728952568, -26.805520317596176},  {271.1593057550778, -22.422858952176},
    {270.0857534501328, -17.958915806362654},  {269.2102580911124, -13.418157280603907},
    {268.5485833675312, -8.816848345693927},   {268.30252229642224, -6.500926575896443},
    {268.11517047271167, -4.179636279914348},  {267.9880675676128, -1.8592521469604364},
    {267.92210023169247, 0.4635485334019904},  {267.91854978489243, 2.7717781527486953},
    {267.97809728354076, 5.079116857505994},   {268.100581383605, 7.358542459056882},
    {268.28740670760675, 9.633490322324235},   {268.53608428288163, 11.870537723682553},
    {268.8493123260384, 14.099401726183771},   {269.2221520384293, 16.286436638617673},
    {269.6586942049814, 18.461635965169876},   {270.15275214683635, 20.59746683736986},
    {270.7092630616682, 22.71786111329601},    {271.3228269094452, 24.80447417754376},
    {271.99812434863617, 26.87185081134362},   {272.7317655726493, 28.909156791382657},
    {273.5272725960537, 30.922961321651485},   {274.3825471558169, 32.905544794157024},
    {275.3001495328388, 34.85988046468049},    {276.27759581459344, 36.77800922850503},
    {277.31747437302755, 38.66283644474578},   {278.416795514161, 40.50655630442115},
    {279.57792566651557, 42.31182691732778},   {280.79967233999514, 44.07447332408494},
    {282.0815772898606, 45.79379571713895},    {283.42701604059755, 47.47247749588038},
    {284.8296348951704, 49.103777698695126},   {286.2996119664259, 50.69896966070571},
    {287.8227764199798, 52.24364881196294},    {289.4200676532612, 53.75917287087714},
    {291.06661783527915, 55.221164259334046},  {292.7986579975826, 56.66103430348464},
    {294.57696928292404, 58.04331805784068},   {296.45069916841805, 59.403973187259666},
    {298.36862614267926, 60.7013251430551},    {300.3781794651584, 61.964427782631404},
    {302.43016181287607, 63.15673925904656},   {304.548600091097, 64.28921814334234},
    {306.70728008274324, 65.34170455694931},   {308.88935692990026, 66.3034342971693},
    {311.10825280409637, 67.17451542969116},   {313.30146984132364, 67.92818396910505},
    {314.40972484159977, 68.26810599796524},   {315.52585096833235, 68.58038675231245},
    {317.68532639173156, 69.1010619526028},    {318.77370565882256, 69.3212465651391},
    {319.8673840107984, 69.51232615656863},    {320.9171008527838, 69.66697703629552},
    {321.9704338788566, 69.79427091463296},    {323.0266932321208, 69.89367956889564},
    {324.08518905568, 69.96467477639817},      {325.1092128923136, 70.00540612417771},
    {326.13402459289875, 70.01858128594458},   {327.15891065528507, 70.00473903559012},
    {328.18315757732245, 69.96441814700569},   {329.18830206194724, 69.89849136206928},
    {330.19145406548853, 69.80617659138284},   {332.1894882163014, 69.54570978795181},
    {333.1795377060756, 69.3788661414604},     {334.1651370677531, 69.18710359746638},
    {336.12114929970636, 68.73190982054439},   {338.0603598006584, 68.18067270981808},
    {339.97182483365594, 67.5385468193943},    {341.866075256668, 66.80330104225027},
    {343.7258379919994, 65.98365078946796},    {345.573454351259, 65.07152740451659},
    {347.3804585460577, 64.08083335661024},    {349.188813736618, 62.98847484858058},
    {350.94973458117323, 61.82108719565764},   {352.7247291393354, 60.534198954719955},
    {354.44466751874137, 59.17447937051372},   {356.17894899044893, 57.681205329217235},
    {357.8519634489001, 56.118985861624765},   {359.52638619931037, 54.42594192543723},
    {361.1378210524902, 52.67174373388764},    {362.7335952907529, 50.808125409332604},
    {364.27019868725114, 48.894262934745996},  {365.7771212224743, 46.90313460546399},
    {367.2323613504413, 44.87303931214973},    {370.0190440225621, 40.698732297347476},
    {372.62992366483905, 36.455381216267426},  {375.06361339475933, 32.21390772742973},
    {377.3135675598774, 28.018617872830475},   {379.37307675599453, 23.870297701314712},
    {381.24443483663373, 19.730466608177892},  {382.93845936513577, 15.552821545899178},
    {384.46272680327246, 11.313853602920062},  {385.8148062210776, 7.014003442134367},
    {386.9881147453262, 2.656501294070324},    {387.9763091856268, -1.7643586826615092},
    {388.39815697682184, -4.0037614166877615}, {388.76514875139463, -6.2524772925401635},
    {389.07633827213357, -8.519746590810636},  {389.3230929380364, -10.794288339415345},
    {389.5008550512977, -13.080621055255106},  {389.6008673092604, -15.370693147320878},
    {389.61603001073183, -17.674451020925872}, {389.53831605397653, -19.975745928362755},
    {389.3589350887716, -22.289739227435074},  {389.2301374686224, -23.442580504328525},
    {389.0716608659073, -24.591422587428838},  {388.8847175931121, -25.73541869608461},
    {388.67029217580335, -26.874229968547056}, {388.4255321412257, -28.006414089182577},
    {388.14758501662374, -29.13052874235757},  {387.84514540571394, -30.220451335530807},
    {387.51301252866165, -31.301183791625434}, {387.14793357201046, -32.37051430047532},
    {386.74665572230396, -33.42623105191433},  {386.3322254621974, -34.41741277732308},
    {385.8868012133801, -35.39433943755347},   {385.4070685596794, -36.35385928802927},
    {384.88971308492245, -37.29282058417425},  {384.3715920482493, -38.15292492374475},
    {383.8222500092968, -38.99254373701146},   {383.23917331592475, -39.80781840995634},
    {382.6198483159929, -40.59489032856135},   {382.00576472536693, -41.30699872121708},
    {381.3618722226803, -41.991411289530426},  {380.68737539035544, -42.644430282661055},
    {380.33840178258555, -42.95801164139524},  {379.9814788108144, -43.262357949768614},
    {379.277297727304, -43.81907812297683},    {378.5471797698057, -44.34081362781734},
    {378.1727369332764, -44.58780735142744},   {377.7922208422085, -44.825149174138936},
    {377.40576848458824, -45.052537184682905}, {377.0135168484017, -45.26966947179045},
    {376.62175210759887, -45.47330980172763},  {376.2248647588854, -45.6668005356069},
    {375.8231329552566, -45.850062076422944},  {375.4168348497078, -46.02301482717044},
    {375.0062485952346, -46.185579190844074},  {374.591652344832, -46.33767557043851},
    {374.17332425149567, -46.47922436894846},  {373.75154246822086, -46.61014598936856},
    {373.31892712162494, -46.732200678424775}, {372.8831902721506, -46.84285180864173},
    {372.44464563001895, -46.94227813142164},  {372.00360690545074, -47.03065839816672},
    {371.1153020498886, -47.174995769161285},  {370.22078538723196, -47.27729393284321},
    {369.7478018087602, -47.31408490250332},   {369.2738984039053, -47.33866223712419},
    {368.32429519464426, -47.35324451513058},  {367.37390191864426, -47.325177794627066},
    {366.4246447351009, -47.25859910337837},   {365.39959001966247, -47.142346141658635},
    {364.3795588964271, -46.980952495467506},  {363.36497753524606, -46.780885300050585},
    {362.35627210597085, -46.548611690653445}, {361.26138357076525, -46.257146370090915},
    {360.17668351264797, -45.9263947467463},   {359.1009779365269, -45.56355923468573},
    {358.03307284731017, -45.17584224797537},  {356.8926257259817, -44.729608848619534},
    {355.76398058161806, -44.25255159162347},  {353.53348052378686, -43.232054796538876},
    {351.25251741448756, -42.09252030791788},  {349.0048268722466, -40.885142836698265},
    {344.6179639519485, -38.33669092118049},   {340.4833114735479, -35.72197134297414},
    {336.60239849964677, -33.050133902445054}, {332.9049935116985, -30.253927123019537},
    {329.3292881786835, -27.284323366055048},  {325.8578218531317, -24.145285262843743},
    {322.49759670748114, -20.86537087683206},  {319.25807547053813, -17.47371921595004},
    {316.14859557964184, -13.998353526694416}, {313.17686655125914, -10.463054728677662},
    {310.34585728041765, -6.880729108294588},  {307.64999907102373, -3.2481509553608134},
    {305.0753720213957, 0.45001496562565535},  {302.6067535391447, 4.228982647610053},
    {300.2371724276615, 8.09444180039361},     {297.972243803822, 12.044155027171769},
    {295.82205478102225, 16.083524649190736},  {293.78507209343667, 20.243804113107785},
    {291.8449136040845, 24.578359622604637},   {289.9910148344042, 29.12845944488066},
    {288.2453732220511, 33.885635333918685},   {286.6684008277785, 38.784005173717844},
    {285.97065849036596, 41.246151178691065},  {285.34102699309636, 43.72573293717261},
    {284.80059666186986, 46.159984422614585},  {284.34309174933804, 48.61000014709424},
    {283.9925003399501, 50.97168399480559},    {283.73877384640906, 53.344338830482116},
    {283.5986664439879, 55.5938314319168},     {283.56768765479353, 56.71979689737443},
    {283.56696142437437, 57.84584875040724},   {283.5934633824474, 58.89917359819043},
    {283.6461696468464, 59.95113187977325},    {283.72825826547086, 61.00067301406747},
    {283.84290728622074, 62.04674641998491},   {283.97936666836534, 63.019698964547175},
    {284.144014193767, 63.987885748932},       {284.3394863810486, 64.94977143138667},
    {284.56841974883326, 65.90382067015844},   {284.81482687383027, 66.7937774323158},
    {285.09074866285334, 67.67475731695583},   {285.39746345721767, 68.54511423950215},
    {285.73624959823866, 69.4032021153784},    {286.090943570685, 70.21201137674646},
    {286.47477846656534, 71.00730705010719},   {286.88770929508485, 71.78775334735904},
    {287.32969106544857, 72.55201448040054},   {287.78942588225334, 73.28191957822418},
    {288.2761361813067, 73.99410469213174},    {288.78919463813827, 74.68752322565692},
    {289.3279739282776, 75.36112858233344},    {289.8897873339713, 76.01156299308596},
};

// Naive O(n) but optimized (cache friendly, no allocations) implementation of
// computing intersections points between all pairs of non-consecutive segments
// in a polyline.
//
Int naiveCountIntersectionPoints(const Vec2dArray& polyline) {
    Int numSegments = polyline.length() - 1;
    Int count = 0;
    for (Int i = 0; i < numSegments; ++i) {
        Segment2 seg1(polyline.getUnchecked(i), polyline.getUnchecked(i + 1));
        for (Int j = i + 2; j < numSegments; ++j) { // +2 to discard consecutive segments
            Segment2 seg2(polyline.getUnchecked(j), polyline.getUnchecked(j + 1));
            SegmentIntersection2d x = seg1.intersect(seg2);
            count += static_cast<Int>(x.type() == SegmentIntersectionType::Point);
        }
    }
    return count;
}

void printTime(std::string_view caption, double t) {
    std::cout << caption << std::setw(10) << secondsToString(t, TimeUnit::Microseconds)
              << std::endl;
}

std::tuple<Int, double, double> benchmark(std::string name, const Vec2dArray& polyline) {

    vgc::core::Stopwatch sw;
    double tNaive = 0;
    double tIntersector = 0;
    Int cNaive = 0;
    Int cIntersector = 0;

    Int numIter = 10;
    for (Int k = 0; k < numIter; ++k) {
        sw.restart();
        cNaive = naiveCountIntersectionPoints(polyline);
        tNaive += sw.elapsed();

        sw.restart();
        SegmentIntersector2d intersector;
        intersector.addPolyline(polyline);
        intersector.computeIntersections();
        cIntersector = intersector.intersectionPoints().length();
        tIntersector += sw.elapsed();
    }
    tNaive /= numIter;
    tIntersector /= numIter;

    printTime(name + " / Naive:                ", tNaive);
    printTime(name + " / SegmentIntersector2d: ", tIntersector);

    EXPECT_EQ(cNaive, cIntersector);

    return {cNaive, tNaive, tIntersector};
}

TEST(TestSegmentIntersector2, Benchmark200) {
    auto [count, tNaive, tIntersector] = benchmark("Benchmark200", polyline200);
    EXPECT_EQ(count, 1);
    EXPECT_LT(tIntersector, 10 * tNaive); // Intersector must not be more than 10x slower
}

TEST(TestSegmentIntersector2, Benchmark1k) {
    auto [count, tNaive, tIntersector] = benchmark("Benchmark1k", polyline1k);
    EXPECT_EQ(count, 27);
    EXPECT_LT(tIntersector, tNaive); // Intersector must be faster
}

TEST(TestSegmentIntersector2, Benchmark10k) {
    Vec2dArray polyline10k;
    for (Int i = 0; i < 10; ++i) {
        Vec2d offset(vgc::core::narrow_cast<double>(i) * 10, 0);
        for (Vec2d p : polyline1k) {
            polyline10k.append(p + offset);
        }
    }
    auto [count, tNaive, tIntersector] = benchmark("Benchmark10k", polyline10k);
    EXPECT_EQ(count, 3155);
    EXPECT_LT(10 * tIntersector, tNaive); // Intersector must be at least 10x faster
}

int main(int argc, char** argv) {
    ::testing::InitGoogleTest(&argc, argv);
    return RUN_ALL_TESTS();
}
